(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[466],{7098:function(e,t,n){(window.__NEXT_P=window.__NEXT_P||[]).push(["/add_user_to_room",function(){return n(9979)}])},9979:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return y}});var r=n(5666),o=n.n(r),c=n(5893),a=n(9008),i=(n(1664),n(1163)),s=n(7294),u=n(7015),l=n(2804),f=n(9707),d=n(5303),h=n(2033);n(9361);function m(e,t,n,r,o,c,a){try{var i=e[c](a),s=i.value}catch(u){return void n(u)}i.done?t(s):Promise.resolve(s).then(r,o)}function p(e){return function(){var t=this,n=arguments;return new Promise((function(r,o){var c=e.apply(t,n);function a(e){m(c,r,o,a,i,"next",e)}function i(e){m(c,r,o,a,i,"throw",e)}a(void 0)}))}}function x(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=[],r=!0,o=!1,c=void 0;try{for(var a,i=e[Symbol.iterator]();!(r=(a=i.next()).done)&&(n.push(a.value),!t||n.length!==t);r=!0);}catch(s){o=!0,c=s}finally{try{r||null==i.return||i.return()}finally{if(o)throw c}}return n}(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function v(e){return function(e){if(Array.isArray(e)){for(var t=0,n=new Array(e.length);t<e.length;t++)n[t]=e[t];return n}}(e)||function(e){if(Symbol.iterator in Object(e)||"[object Arguments]"===Object.prototype.toString.call(e))return Array.from(e)}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function y(e){var t=(0,i.useRouter)(),n=x((0,l.FV)(u.KL),2),r=n[0],m=(n[1],(0,s.useState)(!1)),y=m[0],j=m[1],w=(0,s.useState)([]),_=w[0],g=w[1],b=t.query.id;(0,s.useEffect)((function(){null!=r&&p(o().mark((function e(){var t,n,c,a,i;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(y){e.next=10;break}return t=localStorage.getItem("token"),e.next=4,fetch("".concat(h.FM,"://").concat(h.O9,"/restricted/get_rooms"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(t)},body:JSON.stringify({room_ids:r.room_ids})}).catch((function(){return null}));case 4:if(null==(n=e.sent)){e.next=10;break}return e.next=8,n.json().catch((function(){return null}));case 8:null!=(c=e.sent).result&&0===c.result&&(a=c.rooms,j(!0),i=[],a.map((function(e,t){""==e.icon&&(e.icon=h.FK),i.push({id:e.id,name:e.name,icon:e.icon,num_unread:0,last_update:new Date,last_message:""})})),g(v(_).concat(v(i))));case 10:case"end":return e.stop()}}),e)})))()}),[_,r]);var N=p(o().mark((function e(n){var r,c,a,i,s;return o().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return r={room_id:n,adduser_id:b},c=localStorage.getItem("token"),e.next=4,fetch("".concat(h.FM,"://").concat(h.O9,"/restricted/add_user_to_room"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(c)},body:JSON.stringify(r)}).catch((function(){return null}));case 4:return a=e.sent,e.next=7,a.json().catch((function(){return null}));case 7:i=e.sent,console.log(i),0==(s=i.result)?(alert("\u767b\u9332\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002\u304a\u624b\u6570\u3067\u3059\u304c\u3001\u518d\u5ea6\u30ed\u30b0\u30a4\u30f3\u3057\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),localStorage.setItem("token",null),t.push("/user")):alert("Result: ".concat(s));case 11:case"end":return e.stop()}}),e)})));return(0,c.jsx)(f.Z,{children:null==r?(0,c.jsx)("div",{children:"Loading"}):(0,c.jsxs)("div",{className:"flex flex-col items-center justify-center min-h-screen w-full",children:[(0,c.jsxs)(a.default,{children:[(0,c.jsx)("title",{children:"\u81ea\u5206\u306e\u8a2d\u5b9a"}),(0,c.jsx)("meta",{"http-equiv":"cache-control",content:"no-cache"}),(0,c.jsx)("meta",{"http-equiv":"expires",content:"0"}),(0,c.jsx)("meta",{"http-equiv":"pragma",content:"no-cache"})]}),(0,c.jsx)(d.Z,{title:"\u90e8\u5c4b\u306b\u8ffd\u52a0"}),(0,c.jsxs)("main",{className:"flex flex-col items-center justify-start w-full flex-1 container bg-zinc-100 space-y-2",children:[(0,c.jsx)("p",{children:"\u8ffd\u52a0\u3057\u305f\u3044\u90e8\u5c4b\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044"}),_.map((function(e,t){return(0,c.jsxs)("div",{onClick:function(t){return N(e.id)},className:"w-9/12 max-w-md border-2 border-zinc-300 py-2 px-4 flex rounded-lg cursor-pointer",children:[(0,c.jsx)("div",{className:"",children:(0,c.jsx)("img",{className:"w-16 h-16 shadow-lg rounded-full mx-2 object-contain",src:e.icon,alt:""})}),(0,c.jsx)("div",{className:"flex-grow text-left px-4 py-2 flex flex-col justify-center",children:(0,c.jsx)("p",{className:"text-sm mb-1",children:e.name})})]},t)}))]})]})})}}},function(e){e.O(0,[300,533,774,888,179],(function(){return t=7098,e(e.s=t);var t}));var t=e.O();_N_E=t}]);