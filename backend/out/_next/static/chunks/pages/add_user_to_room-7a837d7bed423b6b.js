(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[466],{7098:function(t,n,e){(window.__NEXT_P=window.__NEXT_P||[]).push(["/add_user_to_room",function(){return e(9979)}])},9979:function(t,n,e){"use strict";e.r(n),e.d(n,{default:function(){return y}});var r=e(5666),o=e.n(r),c=e(5893),a=e(9008),i=(e(1664),e(1163)),u=e(7294),s=e(7015),l=e(2804),f=e(9707),d=e(5303),h=e(2033);e(9361);function m(t,n,e,r,o,c,a){try{var i=t[c](a),u=i.value}catch(s){return void e(s)}i.done?n(u):Promise.resolve(u).then(r,o)}function p(t){return function(){var n=this,e=arguments;return new Promise((function(r,o){var c=t.apply(n,e);function a(t){m(c,r,o,a,i,"next",t)}function i(t){m(c,r,o,a,i,"throw",t)}a(void 0)}))}}function x(t,n){return function(t){if(Array.isArray(t))return t}(t)||function(t,n){var e=[],r=!0,o=!1,c=void 0;try{for(var a,i=t[Symbol.iterator]();!(r=(a=i.next()).done)&&(e.push(a.value),!n||e.length!==n);r=!0);}catch(u){o=!0,c=u}finally{try{r||null==i.return||i.return()}finally{if(o)throw c}}return e}(t,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance")}()}function v(t){return function(t){if(Array.isArray(t)){for(var n=0,e=new Array(t.length);n<t.length;n++)e[n]=t[n];return e}}(t)||function(t){if(Symbol.iterator in Object(t)||"[object Arguments]"===Object.prototype.toString.call(t))return Array.from(t)}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance")}()}function y(t){var n=(0,i.useRouter)(),e=x((0,l.FV)(s.KL),2),r=e[0],m=(e[1],(0,u.useState)(!1)),y=m[0],j=m[1],w=(0,u.useState)([]),_=w[0],g=w[1],b=n.query.id;(0,u.useEffect)((function(){null!=r&&p(o().mark((function t(){var n,e,c,a,i;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(y){t.next=10;break}return n=localStorage.getItem("token"),t.next=4,fetch("".concat(h.FM,"://").concat(h.O9,"/restricted/get_rooms"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(n)},body:JSON.stringify({room_ids:r.room_ids})}).catch((function(){return null}));case 4:if(null==(e=t.sent)){t.next=10;break}return t.next=8,e.json().catch((function(){return null}));case 8:null!=(c=t.sent).result&&0===c.result&&(a=c.rooms,j(!0),i=[],a.map((function(t,n){""==t.icon&&(t.icon=h.FK),i.push({id:t.id,name:t.name,icon:t.icon,num_unread:0,last_update:new Date,last_message:""})})),g(v(_).concat(v(i))));case 10:case"end":return t.stop()}}),t)})))()}),[_,r]);var N=p(o().mark((function t(e){var r,c,a,i,u;return o().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return r={room_id:e,adduser_id:b},c=localStorage.getItem("token"),t.next=4,fetch("".concat(h.FM,"://").concat(h.O9,"/restricted/add_user_to_room"),{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(c)},body:JSON.stringify(r)}).catch((function(){return null}));case 4:return a=t.sent,t.next=7,a.json().catch((function(){return null}));case 7:i=t.sent,console.log(i),0==(u=i.result)?(alert("\u767b\u9332\u5b8c\u4e86\u3057\u307e\u3057\u305f\u3002\u304a\u624b\u6570\u3067\u3059\u304c\u3001\u518d\u5ea6\u30ed\u30b0\u30a4\u30f3\u3057\u76f4\u3057\u3066\u304f\u3060\u3055\u3044\u3002"),localStorage.setItem("token",null),n.push("/user")):alert("Result: ".concat(u));case 11:case"end":return t.stop()}}),t)})));return(0,c.jsx)(f.Z,{children:null==r?(0,c.jsx)("div",{children:"Loading"}):(0,c.jsxs)("div",{className:"bg-gradient-to-r from-cyan-500 to-blue-500 font-mono flex flex-col items-center justify-center min-h-screen w-full",children:[(0,c.jsxs)(a.default,{children:[(0,c.jsx)("title",{children:"\u81ea\u5206\u306e\u8a2d\u5b9a"}),(0,c.jsx)("meta",{httpEquiv:"cache-control",content:"no-cache"}),(0,c.jsx)("meta",{httpEquiv:"expires",content:"0"}),(0,c.jsx)("meta",{httpEquiv:"pragma",content:"no-cache"})]}),(0,c.jsx)(d.Z,{title:"\u90e8\u5c4b\u306b\u8ffd\u52a0"}),(0,c.jsxs)("main",{className:"flex flex-col items-center justify-start w-full flex-1 container bg-zinc-100 space-y-2",children:[(0,c.jsx)("p",{children:"\u8ffd\u52a0\u3057\u305f\u3044\u90e8\u5c4b\u3092\u9078\u629e\u3057\u3066\u304f\u3060\u3055\u3044"}),_.map((function(t,n){return(0,c.jsxs)("div",{onClick:function(n){return N(t.id)},className:"w-9/12 max-w-md border-2 border-zinc-300 py-2 px-4 flex rounded-lg cursor-pointer",children:[(0,c.jsx)("div",{className:"",children:(0,c.jsx)("img",{className:"w-16 h-16 shadow-lg rounded-full mx-2 object-contain",src:t.icon,alt:""})}),(0,c.jsx)("div",{className:"flex-grow text-left px-4 py-2 flex flex-col justify-center",children:(0,c.jsx)("p",{className:"text-sm mb-1",children:t.name})})]},n)}))]})]})})}}},function(t){t.O(0,[300,533,774,888,179],(function(){return n=7098,t(t.s=n);var n}));var n=t.O();_N_E=n}]);